# üöÄ –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –¥–µ–ø–ª–æ—è Medical Center Laravel

## ‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

### 1. –ú–∏–≥—Ä–∞—Ü–∏–∏
- [x] **–ò–°–ü–†–ê–í–õ–ï–ù–û**: `create_applications_table.php` - –¥–æ–±–∞–≤–ª–µ–Ω `AUTO_INCREMENT` –¥–ª—è MySQL
- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [x] **–ò–°–ü–†–ê–í–õ–ï–ù–û**: `.env.example` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram –±–æ—Ç–∞
- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω `config/app.php` - —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω `config/botman.php` - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã API –º–∞—Ä—à—Ä—É—Ç—ã

### 3. –°–∏–¥–µ—Ä—ã
- [x] **–ò–°–ü–†–ê–í–õ–ï–ù–û**: `DatabaseSeeder.php` - –¥–æ–±–∞–≤–ª–µ–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω `ShieldSeeder.php` - —Ä–æ–ª–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### 4. –°–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è
- [x] **–ò–°–ü–†–ê–í–õ–ï–ù–û**: `deploy.sh` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è PHP (8.2/8.3)
- [x] **–ò–°–ü–†–ê–í–õ–ï–ù–û**: `deploy.sh` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (laravel:www-data)

### 5. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω `composer.json` - –≤–∞–ª–∏–¥–Ω—ã–π
- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω `package.json` - —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –Ω–µ—Ç
- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω `.gitignore` - –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π

---

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

### 1. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

#### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- [ ] Ubuntu 22.04 LTS –∏–ª–∏ –Ω–æ–≤–µ–µ
- [ ] PHP 8.2+ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏: mysql, redis, mbstring, xml, bcmath, curl, gd, zip, intl
- [ ] MySQL 8.0+ –∏–ª–∏ PostgreSQL
- [ ] Redis Server
- [ ] Nginx –∏–ª–∏ Apache
- [ ] Composer 2.0+
- [ ] Node.js 18+ –∏ npm

#### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è laravel
adduser --disabled-password --gecos "" laravel
usermod -aG sudo laravel

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –∫–ª—é—á–µ–π
mkdir -p /home/laravel/.ssh
cp /root/.ssh/authorized_keys /home/laravel/.ssh/
chown -R laravel:laravel /home/laravel/.ssh
chmod 700 /home/laravel/.ssh
chmod 600 /home/laravel/.ssh/authorized_keys
```

#### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ë–î –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
mysql -u root -p
CREATE DATABASE medical_center_laravel CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'laravel_user'@'localhost' IDENTIFIED BY 'strong_password_here';
GRANT ALL PRIVILEGES ON medical_center_laravel.* TO 'laravel_user'@'localhost';
FLUSH PRIVILEGES;
EXIT;
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env —Ñ–∞–π–ª–∞

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û**: –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å `.env.example` –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:

```env
APP_NAME="Medical Center"
APP_ENV=production
APP_KEY=base64:generate_key_here
APP_DEBUG=false
APP_TIMEZONE="Europe/Moscow"
APP_URL=https://your-domain.com

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=medical_center_laravel
DB_USERNAME=laravel_user
DB_PASSWORD=strong_password_here

# –ö–µ—à –∏ —Å–µ—Å—Å–∏–∏
CACHE_STORE=redis
SESSION_DRIVER=redis
QUEUE_CONNECTION=redis

# Redis
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

# Telegram Bot (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)
TELEGRAM_TOKEN=your_telegram_bot_token_from_botfather
TELEGRAM_BOT_USERNAME=your_bot_username
TELEGRAM_WEBHOOK_URL=https://your-domain.com/botman
```

### 3. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –¥–µ–ø–ª–æ—è

```bash
# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
cd /var/www/medical-center

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
composer install --no-dev --optimize-autoloader
npm ci --legacy-peer-deps
npm run build

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Laravel
php artisan key:generate
php artisan migrate --force
php artisan db:seed
php artisan storage:link

# –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
php artisan config:cache
php artisan route:cache
php artisan view:cache

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
chown -R laravel:www-data /var/www/medical-center
chmod -R 755 /var/www/medical-center
chmod -R 775 /var/www/medical-center/storage
chmod -R 775 /var/www/medical-center/bootstrap/cache
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –±–æ—Ç–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–æ—Ç–µ
php artisan telegram:info

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ webhook
php artisan telegram:webhook https://your-domain.com/botman

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞
# –û—Ç–ø—Ä–∞–≤—å—Ç–µ /start –±–æ—Ç—É –≤ Telegram
```

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supervisor (–¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π)

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo nano /etc/supervisor/conf.d/laravel-worker.conf
```

```ini
[program:laravel-worker]
process_name=%(program_name)s_%(process_num)02d
command=php /var/www/medical-center/artisan queue:work redis --sleep=3 --tries=3 --max-time=3600
autostart=true
autorestart=true
stopasgroup=true
killasgroup=true
user=laravel
numprocs=4
redirect_stderr=true
stdout_logfile=/var/www/medical-center/storage/logs/worker.log
stopwaitsecs=3600
```

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Supervisor
sudo supervisorctl reread
sudo supervisorctl update
sudo supervisorctl start laravel-worker:*
```

### 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Cron (–¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞)

```bash
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ crontab
sudo crontab -u laravel -e

# –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É:
* * * * * cd /var/www/medical-center && php artisan schedule:run >> /dev/null 2>&1
```

---

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã

### 1. AUTO_INCREMENT –ø—Ä–æ–±–ª–µ–º–∞
**–†–ï–®–ï–ù–û**: –ú–∏–≥—Ä–∞—Ü–∏—è `create_applications_table.php` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞. –ù–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç.

### 2. Telegram –±–æ—Ç
**–í–ê–ñ–ù–û**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- `TELEGRAM_TOKEN`
- `TELEGRAM_BOT_USERNAME` 
- `TELEGRAM_WEBHOOK_URL`

### 3. –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
**–í–ê–ñ–ù–û**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `laravel`, –∞ –Ω–µ `www-data`:
```bash
chown -R laravel:www-data /var/www/medical-center
```

### 4. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
**–í–ê–ñ–ù–û**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MySQL —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π:
```sql
CREATE DATABASE medical_center_laravel CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 5. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
**–í–ê–ñ–ù–û**: –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:
```bash
php artisan config:cache
php artisan route:cache
php artisan view:cache
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### 1. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- [ ] –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: `https://your-domain.com`
- [ ] –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å: `https://your-domain.com/admin`
  - Email: `admin@admin.ru`
  - –ü–∞—Ä–æ–ª—å: `password`

### 2. API
- [ ] –°–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤: `https://your-domain.com/api/v1/cities`
- [ ] –°–ø–∏—Å–æ–∫ –∫–ª–∏–Ω–∏–∫: `https://your-domain.com/api/v1/clinics`

### 3. Telegram –±–æ—Ç
- [ ] –û—Ç–ø—Ä–∞–≤–∏—Ç—å `/start` –±–æ—Ç—É
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç –±–æ—Ç–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å webhook: `https://your-domain.com/botman`

### 4. –õ–æ–≥–∏
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ Laravel
tail -f /var/www/medical-center/storage/logs/laravel.log

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ Nginx
tail -f /var/log/nginx/medical-center_error.log

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ Supervisor
tail -f /var/www/medical-center/storage/logs/worker.log
```

---

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
cd /var/www/medical-center
git pull
composer install --no-dev --optimize-autoloader
npm run build
php artisan migrate --force
php artisan cache:clear
php artisan config:cache
php artisan route:cache
php artisan view:cache
sudo supervisorctl restart laravel-worker:*
```

### –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–µ–π
```bash
php artisan cache:clear
php artisan config:clear
php artisan route:clear
php artisan view:clear
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
sudo systemctl restart nginx
sudo systemctl restart php8.2-fpm  # –∏–ª–∏ php8.3-fpm
sudo systemctl restart mysql
sudo systemctl restart redis-server
sudo supervisorctl restart all
```

---

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç

- [ ] –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- [ ] –°–µ—Ä–≤–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å–æ–≥–ª–∞—Å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- [ ] .env —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] Telegram –±–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] Supervisor –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π
- [ ] Cron –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
- [ ] –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ—Å—Ç—É–ø–µ–Ω
- [ ] API —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Telegram –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç
- [ ] –õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ**
