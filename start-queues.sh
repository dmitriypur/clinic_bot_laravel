#!/bin/bash

echo "üöÄ –ó–∞–ø—É—Å–∫ –æ—á–µ—Ä–µ–¥–µ–π –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞..."
echo ""

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ Laravel —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
if [ ! -f "artisan" ]; then
    echo "‚ùå –û—à–∏–±–∫–∞: –§–∞–π–ª artisan –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ Laravel –ø—Ä–æ–µ–∫—Ç–∞."
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—á–µ—Ä–µ–¥–µ–π
echo "üìã –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—á–µ—Ä–µ–¥–µ–π:"
grep "QUEUE_CONNECTION" .env || echo "QUEUE_CONNECTION –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ .env"

echo ""
echo "üîÑ –ó–∞–ø—É—Å–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –æ—á–µ—Ä–µ–¥–µ–π..."
echo "üí° –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C"
echo ""

# –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—á–µ—Ä–µ–¥–µ–π
php artisan queue:work --verbose --tries=3 --timeout=90
